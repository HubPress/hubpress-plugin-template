"use strict";function writeMetaTag(e,t,s){return s=s||"twitter"===e.substring(0,7)?"name":"property","<meta "+s+'="'+e+'" content="'+t+'" />'}function finaliseStructuredData(e){var t=[];return _.each(e.structuredData,function(s,r){"article:tag"===r?(_.each(e.keywords,function(e){""!==e&&(e=escapeExpression(e),t.push(writeMetaTag(r,escapeExpression(e))))}),t.push("")):null!==s&&void 0!==s&&t.push(writeMetaTag(r,escapeExpression(s)))}),t}function ghost_head(e){if(console.warn("Check ghost_head options",e,this.statusCode,this.context),!(this.statusCode>=400)){var t=getMetaData(this,e.data.root),s=[],r=this.context?Array.isArray(this.context)?this.context[0]:this.context:null,a=!config.isPrivacyDisabled("useStructuredData");this.safeVersion;return r&&(s.push('<link rel="canonical" href="'+escapeExpression(t.canonicalUrl)+'" />'),s.push('<meta name="referrer" content="origin" />'),t.previousUrl&&s.push('<link rel="prev" href="'+escapeExpression(t.previousUrl)+'" />'),t.nextUrl&&s.push('<link rel="next" href="'+escapeExpression(t.nextUrl)+'" />'),"paged"!==r&&"page"!==r&&a&&(s.push(""),s.push.apply(s,finaliseStructuredData(t)),s.push(""),s.push('<script type="application/ld+json">\n'+JSON.stringify(t.schema,null,"    ")+"\n    </script>\n"))),s.push('<meta name="generator" content="HubPress" />'),s.push('<link rel="alternate" type="application/rss+xml" title="'+escapeExpression(t.blog.title)+'" href="'+escapeExpression(t.rssUrl)+'" />'),new SafeString(s.join("\n    ").trim())}}var getMetaData=require("../data/meta"),handlebars=require("handlebars"),hbs={handlebars:handlebars},escapeExpression=hbs.handlebars.Utils.escapeExpression,SafeString=hbs.handlebars.SafeString,_=require("lodash"),config=require("../config");module.exports=ghost_head;