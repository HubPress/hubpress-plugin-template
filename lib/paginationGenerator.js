"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),_lodash=require("lodash"),_lodash2=_interopRequireDefault(_lodash),_builder=require("./builder"),_builder2=_interopRequireDefault(_builder),_hubpressCoreSlugify=require("hubpress-core-slugify"),_hubpressCoreSlugify2=_interopRequireDefault(_hubpressCoreSlugify),PaginationGenerator=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"generate",value:function(e){console.info("PaginationGenerator - generate"),console.log("PaginationGenerator - generate",e);var t=e.posts,a=e.opts.data.config,r=a.site;r.url=a.urls.site;var l=1,o=(e.path||"")+"index.html",n=[],i=[],s=parseInt(r.postsPerPage||10,10),u=({name:e.opts.data.theme.name,version:e.opts.data.theme.version,url:a.urls.theme},a.urls,a.socialnetwork);if(!t||!t.length){var p=_builder2["default"].template(e.template,{pagination:{prev:0,next:0,page:0,pages:0,total:0,limit:s},posts:[],tag:e.tag,author:e.author,socialnetwork:u,title:r.title},_lodash2["default"].pick(e.opts.data,["config","theme"]));i.push({name:"page-"+l,path:o,content:p,message:"Publish page-"+l+" "+e.template});var h=(e.opts.data.elementsToPublish||[]).concat(i),c=Object.assign({},e.opts.data,{elementsToPublish:h});return Object.assign({},e.opts,{data:c})}var g=Math.ceil(t.length/s);_lodash2["default"].each(t,function(a,p){var h=0,c=0;l>1&&(o=(e.path||"")+("page/"+l+"/index.html")),l>1&&(c=l-1),g>l&&(h=l+1);var d=void 0;a.tags&&(d=_lodash2["default"].map(a.tags,function(e){return{name:e,slug:(0,_hubpressCoreSlugify2["default"])(e),description:null}}));var f={id:a.author.id,name:a.author.name||a.author.login,location:a.author.location,website:a.author.blog,image:a.author.avatar_url,slug:a.author.login};if(n.push({image:a.image,title:a.title,url:r.url+a.url,excerpt:a.excerpt,html:a.excerpt,tags:d,published_at:a.published_at,relativeUrl:r.url+a.url,author:f}),Math.floor((p+1)/s)>l-1||p+1===t.length){var m=_builder2["default"].template(e.template,{pagination:{prev:c,next:h,page:l,pages:g,total:t.length,limit:s},context:"index"===e.template&&0===c?"home":e.template,posts:n,tag:e.tag,author:e.author,title:r.title,description:r.description,socialnetwork:u,relativeUrl:""},_lodash2["default"].pick(e.opts.data,["config","theme"]));i.push({name:"page-"+l,path:o,content:m,message:"Publish page-"+l+" "+e.template}),n=[],l++}});var d=(e.opts.data.elementsToPublish||[]).concat(i),f=Object.assign({},e.opts.data,{elementsToPublish:d});return Object.assign({},e.opts,{data:f})}}]),e}();exports["default"]=new PaginationGenerator,module.exports=exports["default"];